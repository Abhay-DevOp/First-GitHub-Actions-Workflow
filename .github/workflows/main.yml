name : Devops CI Pipeline

on:
  push :
    branches : ["main"]

jobs:
  build-test-docker:
    runs-on: ubuntu-latest

    steps:
#      - name: checkoutcode
#        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version : 18

 #     - name: Install dependencies
 #       run : npm install

      - name: Run tests
        run: npm test

      - name: Login into Docker
        uses: docker/login-action@v3
        with:
          username : $ {{secrets.DOCKER_USERNAME}}
          password : $ {{secrets.DOCKER_PASSWORD}}

      - name: Buid Docker Image
        run: docker build -t myapp.latest .

      - name: Tag Docker Image
        run: docker tag myapp:latest $ {{secrets.DOCKER_USERNAME}}/myapp:latest

      - name: Push Docker Image into Docker Hub
        run: dockerpush $ {{secrets.DOCKER_USERNAME}}/myapp:latest
      


